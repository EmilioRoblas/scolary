-- USUARIOS (profesores y tutores)
CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100),
    email VARCHAR(100) UNIQUE,
    password VARCHAR(255),
    rol ENUM('profesor', 'tutor') NOT NULL
);

-- AULAS
CREATE TABLE aulas (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(50)
);

-- ALUMNOS
CREATE TABLE alumnos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100),
    id_tutor INT,
    id_aula INT,
    FOREIGN KEY (id_tutor) REFERENCES usuarios(id),
    FOREIGN KEY (id_aula) REFERENCES aulas(id)
);

-- ASISTENCIA A CLASE
CREATE TABLE asistencias (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_alumno INT,
    fecha DATE,
    presente BOOLEAN,
    FOREIGN KEY (id_alumno) REFERENCES alumnos(id)
);

-- LISTA DE COMEDOR (AUTOMÁTICA)
CREATE TABLE comedor (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_alumno INT,
    fecha DATE,
    confirmado BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (id_alumno) REFERENCES alumnos(id)
);

-- AUTORIZACIONES
CREATE TABLE autorizaciones (
    id INT AUTO_INCREMENT PRIMARY KEY,
    titulo VARCHAR(100),
    descripcion TEXT,
    tipo ENUM('excursion', 'falta', 'otro'),
    fecha_creacion DATE,
    id_profesor INT,
    id_alumno INT,
    FOREIGN KEY (id_profesor) REFERENCES usuarios(id),
    FOREIGN KEY (id_alumno) REFERENCES alumnos(id)
);

-- FIRMAS DE AUTORIZACIÓN
CREATE TABLE firmas_autorizacion (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_autorizacion INT,
    firmado_por ENUM('tutor', 'profesor'),
    fecha_firma DATETIME,
    FOREIGN KEY (id_autorizacion) REFERENCES autorizaciones(id)
);
